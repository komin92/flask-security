{% extends "security/base.html" %}
{% from "security/_macros.html" import render_field_with_errors, render_field, render_field_errors %}

{% block content %}
    {% include "security/_messages.html" %}
    <h1>{{ _("Sign In") }}</h1>
      <form action="{{ url_for_security("pl_login") }}" method="POST"
          name="pl_login_form">
      {{ pl_login_form.hidden_tag() }}
      {{ render_field_with_errors(pl_login_form.identity) }}
      {{ render_field_with_errors(pl_login_form.passcode) }}
      {{ render_field_with_errors(pl_login_form.remember) }}
      {{ render_field(pl_login_form.submit) }}
      {% if methods %}
        <h4>{{  _("Request one-time-password be sent") }}</h4>
        {% for subfield in pl_login_form.chosen_method %}
          {% if subfield.data in methods %}
            {{ render_field_with_errors(subfield) }}
          {% endif %}
        {% endfor %}
        {{ render_field_errors(pl_login_form.chosen_method) }}
        {% if code_sent %}
          <p>{{ _("Code has been sent") }}
        {% endif %}
        {{ render_field(pl_login_form.submit_send_code, formaction=url_for_security('pl_send_code')) }}
      {% endif %}
      </form>
  {% include "security/_menu.html" %}
{% endblock %}
